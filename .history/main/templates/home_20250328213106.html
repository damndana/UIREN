{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Share Skill, Get Skill</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&family=Raleway:wght@400;700&family=Tektur&family=DM+Sans&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>

  <nav class="navbar">
    <div class="nav-left">
      <a href="{% url 'home' %}">Home</a>
      <a href="{% url 'courses' %}">Courses</a>
      <div class="dropdown">
        <button class="dropbtn">Categories</button>
        <div class="dropdown-content">
          <a href="#">Design</a>
          <a href="#">Web Dev</a>
          <a href="#">Marketing</a>
          <a href="#">Music</a>
        </div>
      </div>
    </div>
    <div class="nav-right">
      <a href="{% url 'about' %}">About Us</a>
      <a href="{% url 'signin' %}">Sign In / Register</a>
    </div>
  </nav>

  <video autoplay muted loop id="bg-video">
    <source src="{% static 'videos/Background.mov' %}" type="video/mp4">
  </video>

  <section class="hero-content" style="margin-top: 150px;">
    <h1 class="hero-title">Share Skill, Get Skill</h1>

    <!-- ✅ FILTER BUTTONS RESTORED -->
    <div class="filter-buttons">
      <button>Newest</button>
      <button>Popular</button>
      <button>High Rating</button>
    </div>

    <!-- ✅ SEARCH BAR -->
    <div class="search-wrapper">
      <input id="home-search" class="search-input" placeholder="Search here..." type="text" />
      <span class="search-icon">
        <img src="{% static '/animations/rocket (1).png' %}" alt="Search Icon" />
      </span>
    </div>

    <!-- ✅ CAROUSEL (BIGGER + MARGIN) -->
    <div class="carousel-wrapper" style="margin-top: 50px;">
      <div class="carousel">
        <div class="card"><lottie-player src="{% static 'animations/webdev.json' %}" background="transparent" speed="1" loop autoplay></lottie-player><p>Web Development</p></div>
        <div class="card"><lottie-player src="{% static 'animations/graphicdesign.json' %}" background="transparent" speed="1" loop autoplay></lottie-player><p>Design</p></div>
        <div class="card"><lottie-player src="{% static 'animations/outbound-marketing.json' %}" background="transparent" speed="1" loop autoplay></lottie-player><p>Marketing</p></div>
        <div class="card"><lottie-player src="{% static 'animations/AI.json' %}" background="transparent" speed="1" loop autoplay></lottie-player><p>AI & ML</p></div>
        <div class="card"><lottie-player src="{% static 'animations/musician-in-studio.json' %}" background="transparent" speed="1" loop autoplay></lottie-player><p>Music</p></div>
        <div class="card"><lottie-player src="{% static 'animations/content-creator-for-digital-marketing.json' %}" background="transparent" speed="1" loop autoplay></lottie-player><p>Public Speech</p></div>
      </div>
    </div>
  </section>
  <script>
    const carousel = document.querySelector('.carousel');
    const searchInput = document.getElementById("home-search");
  
    if (carousel) {
      const originalCards = Array.from(carousel.children); // keep original refs
  
      // Duplicate cards for infinite scroll
      const duplicate = carousel.innerHTML;
      carousel.innerHTML += duplicate;
  
      let scrollAmount = 0;
      function autoScroll() {
        scrollAmount += 3;
        carousel.scrollLeft = scrollAmount;
        if (scrollAmount >= carousel.scrollWidth / 2) scrollAmount = 0;
        requestAnimationFrame(autoScroll);
      }
      autoScroll();
  
      // ✅ Real-time search filter (keep Lottie animations!)
      searchInput.addEventListener("input", () => {
        const query = searchInput.value.toLowerCase();
        carousel.innerHTML = ""; // Clear carousel
  
        originalCards.forEach((card) => {
          const title = card.querySelector("p").textContent.toLowerCase();
          if (title.includes(query)) {
            carousel.appendChild(card.cloneNode(true)); // preserve lottie
          }
        });
  
        // Reload lottie-players in new DOM
        setTimeout(() => {
          carousel.querySelectorAll("lottie-player").forEach(player => player.load());
        }, 10);
      });
    }
    searchInput.addEventListener("input", () => {
  const query = searchInput.value.toLowerCase();
  carousel.innerHTML = "";

  allCards.forEach((card) => {
    const title = card.querySelector("p").textContent.toLowerCase();
    if (title.includes(query)) {
      const newCard = document.createElement("div");
      newCard.className = "card";

      const lottie = document.createElement("lottie-player");
      lottie.setAttribute("src", card.querySelector("lottie-player").getAttribute("src"));
      lottie.setAttribute("background", "transparent");
      lottie.setAttribute("speed", "1");
      lottie.setAttribute("loop", "");
      lottie.setAttribute("autoplay", "");

      const text = document.createElement("p");
      text.textContent = card.querySelector("p").textContent;

      newCard.appendChild(lottie);
      newCard.appendChild(text);

      carousel.appendChild(newCard);
    }
  });
});

  </script>
  
</body>
</html>
